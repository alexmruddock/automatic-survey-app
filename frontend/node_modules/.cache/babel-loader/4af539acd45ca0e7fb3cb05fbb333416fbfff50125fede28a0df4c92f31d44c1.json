{"ast":null,"code":"var _jsxFileName = \"/workspaces/automatic-survey-app/frontend/src/LoginForm.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction LoginForm({\n  setUserDetails\n}) {\n  _s();\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const navigate = useNavigate();\n  const handleSubmit = async event => {\n    event.preventDefault();\n    const response = await fetch(\"https://bookish-pancake-q7w7vvr66ggfxp5j-3000.app.github.dev/login\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        email,\n        password\n      })\n    });\n\n    // Check if the response is JSON\n    const contentType = response.headers.get(\"content-type\");\n    if (contentType && contentType.includes(\"application/json\")) {\n      const data = await response.json();\n      if (response.ok) {\n        // Handle successful response\n        console.log(\"Data: \", data);\n        localStorage.setItem(\"accessToken\", data.accessToken);\n        localStorage.setItem(\"refreshToken\", data.refreshToken);\n        localStorage.setItem(\"userEmail\", email);\n        // fetch user role here and update state in App\n        fetchUserRole().then(role => setUserDetails(email, role));\n        navigate(\"/\");\n      } else {\n        // Handle error in JSON response\n        console.error(\"Login failed:\", data.message);\n      }\n    } else {\n      // Handle non-JSON response\n      const text = await response.text();\n      console.error(\"Non-JSON response:\", text);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleSubmit,\n    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"email\",\n      value: email,\n      onChange: e => setEmail(e.target.value),\n      placeholder: \"Email\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"password\",\n      value: password,\n      onChange: e => setPassword(e.target.value),\n      placeholder: \"Password\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"submit\",\n      children: \"Login\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 48,\n    columnNumber: 5\n  }, this);\n}\n_s(LoginForm, \"rIjyA2uJXTJXGlQGcq/HSho2Mo8=\", false, function () {\n  return [useNavigate];\n});\n_c = LoginForm;\nasync function fetchUserRole() {\n  const response = await fetch(\"https://bookish-pancake-q7w7vvr66ggfxp5j-3000.app.github.dev/fetch-user\", {\n    headers: {\n      \"Authorization\": `Bearer ${localStorage.getItem('accessToken')}`\n    }\n  });\n  if (response.ok) {\n    const data = await response.json();\n    return data.role;\n  }\n  return null;\n}\nexport default LoginForm;\nvar _c;\n$RefreshReg$(_c, \"LoginForm\");","map":{"version":3,"names":["React","useState","useNavigate","jsxDEV","_jsxDEV","LoginForm","setUserDetails","_s","email","setEmail","password","setPassword","navigate","handleSubmit","event","preventDefault","response","fetch","method","headers","body","JSON","stringify","contentType","get","includes","data","json","ok","console","log","localStorage","setItem","accessToken","refreshToken","fetchUserRole","then","role","error","message","text","onSubmit","children","type","value","onChange","e","target","placeholder","fileName","_jsxFileName","lineNumber","columnNumber","_c","getItem","$RefreshReg$"],"sources":["/workspaces/automatic-survey-app/frontend/src/LoginForm.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\n\nfunction LoginForm({ setUserDetails }) {\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const navigate = useNavigate();\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n\n    const response = await fetch(\n      \"https://bookish-pancake-q7w7vvr66ggfxp5j-3000.app.github.dev/login\",\n      {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({ email, password }),\n      }\n    );\n\n    // Check if the response is JSON\n    const contentType = response.headers.get(\"content-type\");\n    if (contentType && contentType.includes(\"application/json\")) {\n      const data = await response.json();\n      if (response.ok) {\n        // Handle successful response\n        console.log(\"Data: \", data);\n        localStorage.setItem(\"accessToken\", data.accessToken);\n        localStorage.setItem(\"refreshToken\", data.refreshToken);\n        localStorage.setItem(\"userEmail\", email);\n        // fetch user role here and update state in App\n        fetchUserRole().then(role => setUserDetails(email, role));\n        navigate(\"/\");\n      } else {\n        // Handle error in JSON response\n        console.error(\"Login failed:\", data.message);\n      }\n    } else {\n      // Handle non-JSON response\n      const text = await response.text();\n      console.error(\"Non-JSON response:\", text);\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit}>\n      <input\n        type=\"email\"\n        value={email}\n        onChange={(e) => setEmail(e.target.value)}\n        placeholder=\"Email\"\n      />\n      <input\n        type=\"password\"\n        value={password}\n        onChange={(e) => setPassword(e.target.value)}\n        placeholder=\"Password\"\n      />\n      <button type=\"submit\">Login</button>\n    </form>\n  );\n}\n\nasync function fetchUserRole() {\n  const response = await fetch(\"https://bookish-pancake-q7w7vvr66ggfxp5j-3000.app.github.dev/fetch-user\", {\n    headers: {\n      \"Authorization\": `Bearer ${localStorage.getItem('accessToken')}`,\n    },\n  });\n  if (response.ok) {\n    const data = await response.json();\n    return data.role;\n  }\n  return null;\n}\n\nexport default LoginForm;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}